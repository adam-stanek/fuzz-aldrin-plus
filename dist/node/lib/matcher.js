"use strict";function match(r,e,t){var a=t.allowErrors,s=t.pathSeparator;if(!a&&!(0,_scorer.isMatch)(r,e.core_lw,e.core_up))return[];var o=r.toLowerCase(),c=computeMatch(r,o,e);if(0===c.length)return c;if(r.indexOf(s)>-1){var n=basenameMatch(r,o,e,s);c=mergeMatches(c,n)}return c}function wrap(r,e,t){var a=t.tagClass||"highlight",s=t.tagOpen||'<strong class="'+a+'">',o=t.tagClose||"</strong>";if(r===e.query)return s+r+o;var c=match(r,e,t),n=c.length;if(0===n)return r;for(var i="",u=-1,h=0;++u<n;){var f=c[u];for(f>h&&(i+=r.substring(h,f),h=f);++u<n;){if(c[u]!==f+1){u--;break}f++}f++,f>h&&(i+=s,i+=r.substring(h,f),i+=o,h=f)}return h<r.length-1&&(i+=r.substring(h)),i}function basenameMatch(r,e,t,a){for(var s=r.length-1;r[s]===a;)s--;var o=r.lastIndexOf(a,s);if(o===-1)return[];for(var c=t.depth;c-- >0;)if(o=r.lastIndexOf(a,o-1),o===-1)return[];return o++,s++,computeMatch(r.slice(o,s),e.slice(o,s),t,o)}function mergeMatches(r,e){var t=r.length,a=e.length;if(0===a)return r.slice();if(0===t)return e.slice();for(var s=-1,o=0,c=e[o],n=[];++s<t;){for(var i=r[s];c<=i&&++o<a;)c<i&&n.push(c),c=e[o];n.push(i)}for(;o<a;)n.push(e[o++]);return n}function computeMatch(r,e,t){for(var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=t.query,o=t.query_lw,c=r.length,n=s.length,i=(0,_scorer.scoreAcronyms)(r,e,s,o).score,u=new Array(n),h=new Array(n),f=0,v=1,l=2,p=3,g=new Array(c*n),d=-1,m=-1;++m<n;)u[m]=0,h[m]=0;for(var w=void 0,_=void 0,b=void 0,M=void 0,y=void 0,x=-1;++x<c;){b=0,M=0,y=0;var C=e[x];for(m=-1;++m<n;){var O=0,k=0;if(_=M,o[m]===C){var q=(0,_scorer.isWordStart)(x,r,e);O=y>0?y:(0,_scorer.scoreConsecutives)(r,e,s,o,x,m,q),k=_+(0,_scorer.scoreCharacter)(x,m,q,i,O)}M=u[m],y=h[m],b>M?w=l:(b=M,w=v),k>b?(b=k,w=p):O=0,u[m]=b,h[m]=O,g[++d]=b>0?w:f}}x=c-1,m=n-1,d=x*n+m;for(var A=!0,I=[];A&&x>=0&&m>=0;)switch(g[d]){case v:x--,d-=n;break;case l:m--,d--;break;case p:I.push(x+a),m--,x--,d-=n+1;break;default:A=!1}return I.reverse(),I}Object.defineProperty(exports,"__esModule",{value:!0}),exports.match=match,exports.wrap=wrap;var _scorer=require("./scorer");exports.default={match:match,wrap:wrap};