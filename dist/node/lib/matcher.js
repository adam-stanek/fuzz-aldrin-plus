"use strict";function match(r,e,a){var t=a.allowErrors,s=a.pathSeparator;if(!t&&!(0,_scorer.isMatch)(r,e.core_lw,e.core_up))return[];var o=r.toLowerCase(),c=computeMatch(r,o,e);if(0===c.length)return c;if(r.indexOf(s)>-1){var n=basenameMatch(r,o,e,s);c=mergeMatches(c,n)}return c}function wrap(r,e,a){var t=a.tagClass,s=a.tagOpen,o=a.tagClose;if(s&&s.length&&(s=s.replace("{tagClass}",t)),r===e.query)return s+r+o;var c=match(r,e,a),n=c.length;if(0===n)return r;for(var u="",i=-1,f=0;++i<n;){var h=c[i];for(h>f&&(u+=r.substring(f,h),f=h);++i<n;){if(c[i]!==h+1){i--;break}h++}h++,h>f&&(u+=s,u+=r.substring(f,h),u+=o,f=h)}return f<r.length-1&&(u+=r.substring(f)),u}function basenameMatch(r,e,a,t){for(var s=r.length-1;r[s]===t;)s--;var o=r.lastIndexOf(t,s);if(o===-1)return[];for(var c=a.depth;c-- >0;)if(o=r.lastIndexOf(t,o-1),o===-1)return[];return o++,s++,computeMatch(r.slice(o,s),e.slice(o,s),a,o)}function mergeMatches(r,e){var a=r.length,t=e.length;if(0===t)return r.slice();if(0===a)return e.slice();for(var s=-1,o=0,c=e[o],n=[];++s<a;){for(var u=r[s];c<=u&&++o<t;)c<u&&n.push(c),c=e[o];n.push(u)}for(;o<t;)n.push(e[o++]);return n}function computeMatch(r,e,a){for(var t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=a.query,o=a.query_lw,c=r.length,n=s.length,u=(0,_scorer.scoreAcronyms)(r,e,s,o).score,i=new Array(n),f=new Array(n),h=0,v=1,l=2,p=3,g=new Array(c*n),d=-1,m=-1;++m<n;)i[m]=0,f[m]=0;for(var w=void 0,_=void 0,b=void 0,M=void 0,y=void 0,x=-1;++x<c;){b=0,M=0,y=0;var C=e[x];for(m=-1;++m<n;){var O=0,k=0;if(_=M,o[m]===C){var q=(0,_scorer.isWordStart)(x,r,e);O=y>0?y:(0,_scorer.scoreConsecutives)(r,e,s,o,x,m,q),k=_+(0,_scorer.scoreCharacter)(x,m,q,u,O)}M=i[m],y=f[m],b>M?w=l:(b=M,w=v),k>b?(b=k,w=p):O=0,i[m]=b,f[m]=O,g[++d]=b>0?w:h}}x=c-1,m=n-1,d=x*n+m;for(var A=!0,I=[];A&&x>=0&&m>=0;)switch(g[d]){case v:x--,d-=n;break;case l:m--,d--;break;case p:I.push(x+t),m--,x--,d-=n+1;break;default:A=!1}return I.reverse(),I}Object.defineProperty(exports,"__esModule",{value:!0}),exports.match=match,exports.wrap=wrap;var _scorer=require("./scorer");exports.default={match:match,wrap:wrap};