"use strict";function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function score(r,e,t){var o=t.allowErrors;if(!o&&!isMatch(r,e.core_lw,e.core_up))return 0;var s=r.toLowerCase(),c=computeScore(r,s,e,t);return Math.ceil(c)}function isMatch(r,e,t){var o=r.length,s=e.length;if(!o||s>o)return!1;for(var c=-1,n=-1;++n<s;){for(var a=e.charCodeAt(n),i=t.charCodeAt(n);++c<o;){var u=r.charCodeAt(c);if(u===a||u===i)break}if(c===o)return!1}return!0}function computeScore(r,e,t,o){var s=t.query,c=t.query_lw,n=!0,a=r.length,i=s.length,u=0,f=scoreAcronyms(r,e,s,c),v=f.score;if(f.count===i)return scoreExact(i,a,v,f.pos);var l=e.indexOf(c);if(l>-1)return scoreExactMatch(r,e,s,c,l,i,a);for(var h=new Array(i),p=new Array(i),d=scoreSize(i,a),x=Math.ceil(miss_coeff*i)+5,m=x,S=-1;++S<i;)h[S]=0,p[S]=0;var y=e.indexOf(c[0]);y>-1&&y--;var C=e.lastIndexOf(c[i-1],a);C>y&&(a=C+1);for(var A=!0;++y<a;){var _=e[y];if(null!=t.charCodes[_.charCodeAt(0)]){var E=e[y];u=0;var M=0,W=0,w=!0;for(A=!1,S=-1;++S<i;){var P=h[S];P>u&&(u=P);var b=0,g=c[S];if(g===_){var z=s[S];if(n||g===z||E===z){var k=isWordStart(y,r,e);b=W>0?W:scoreConsecutives(r,e,s,c,y,S,k);var O=M+scoreCharacter(y,S,k,v,b);if(O>u)u=O,m=x;else{if(w&&--m<=0)return h[i-1]*d;w=!1}}}M=P,W=p[S],p[S]=b,h[S]=u}}else if(A!==!0){for(S=-1;++S<i;)p[S]=0;A=!0}}return u=h[i-1],u*d}function isWordStart(r,e,t){if(0===r)return!0;var o=e[r],s=e[r-1];return isSeparator(s)||o!==t[r]&&s===t[r-1]}function isWordEnd(r,e,t,o){if(r===o-1)return!0;var s=e[r],c=e[r+1];return isSeparator(c)||s===t[r]&&c!==t[r+1]}function isSeparator(r){return" "===r||"."===r||"-"===r||"_"===r||"/"===r||"\\"===r}function scorePosition(r){if(r<pos_bonus){var e=pos_bonus-r;return 100+e*e}return Math.max(100+pos_bonus-r,0)}function scoreSize(r,e){return tau_size/(tau_size+Math.abs(e-r))}function scoreExact(r,e,t,o){return 2*r*(wm*t+scorePosition(o))*scoreSize(r,e)}function scorePattern(r,e,t,o,s){var c=r,n=6;return t===r&&(n+=2),o&&(n+=3),s&&(n+=1),r===e&&(o&&(c+=t===e?2:1),s&&(n+=1)),t+c*(c+n)}function scoreCharacter(r,e,t,o,s){var c=scorePosition(r);return t?c+wm*((o>s?o:s)+10):c+wm*s}function scoreConsecutives(r,e,t,o,s,c,n){var a=r.length,i=t.length,u=a-s,f=i-c,v=u<f?u:f,l=0;t[c]===r[s]&&l++;for(var h=0;++h<v&&o[++c]===e[++s];)t[c]===r[s]&&l++;return 1===h?1+2*l:scorePattern(h,i,l,n,isWordEnd(s,r,e,a))}function scoreExactMatch(r,e,t,o,s,c,n){var a=isWordStart(s,r,e);if(!a){var i=e.indexOf(o,s+1);i>-1&&(a=isWordStart(i,r,e),a&&(s=i))}for(var u=-1,f=0;++u<c;)t[s+u]===r[u]&&f++;var v=isWordEnd(s+c-1,r,e,n);return scoreExact(c,n,scorePattern(c,c,f,a,v),s)}function scoreAcronyms(r,e,t,o){var s=r.length,c=t.length;if(s<=1||c<=1)return emptyAcronymResult;for(var n=0,a=0,i=0,u=0,f=-1,v=-1;++v<c;){var l=o[v];if(isSeparator(l)){if(f=e.indexOf(l,f+1),f>-1){a++;continue}break}for(;++f<s;)if(l===e[f]&&isWordStart(f,r,e)){t[v]===r[f]&&u++,i+=f,n++;break}if(f===s)break}if(n<2)return emptyAcronymResult;var h=n===c&&isAcronymFullWord(r,e,t,n),p=scorePattern(n,c,u,!0,h);return new AcronymResult(p,i/n,n+a)}function isAcronymFullWord(r,e,t,o){var s=r.length,c=t.length,n=0;if(s>12*c)return!1;for(var a=-1;++a<s;)if(isWordStart(a,r,e)&&++n>o)return!1;return!0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.score=score,exports.isMatch=isMatch,exports.computeScore=computeScore,exports.isWordStart=isWordStart,exports.isWordEnd=isWordEnd,exports.isSeparator=isSeparator,exports.scorePosition=scorePosition,exports.scoreSize=scoreSize,exports.scoreExact=scoreExact,exports.scorePattern=scorePattern,exports.scoreCharacter=scoreCharacter,exports.scoreConsecutives=scoreConsecutives,exports.scoreExactMatch=scoreExactMatch,exports.scoreAcronyms=scoreAcronyms;var wm=150,pos_bonus=20,tau_size=85,miss_coeff=.75;exports.default={score:score,isMatch:isMatch};var AcronymResult=function r(e,t,o){_classCallCheck(this,r),this.score=e,this.pos=t,this.count=o},emptyAcronymResult=new AcronymResult(0,.1,0);